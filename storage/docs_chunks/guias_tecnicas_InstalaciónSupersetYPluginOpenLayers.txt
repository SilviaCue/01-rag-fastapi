





Manual
	
INSTALACIÓN SUPERSET
+ PLUGIN OPENLAYERS




ÍNDICE
INSTALACIÓN DE SUPERSET	3
Establecer superset como servicio	6
INSTALACIÓN PLUGIN OPENLAYERS	8

INSTALACIÓN DE SUPERSET
Para instalar Superset (SIN PyPi ni Docker) los requisitos del sistema son los siguientes:
Ubuntu 22 (se evita Python 3.12 por compatibilidad)
20GB de disco, 8GB RAM, 2 CPU virtuales
Instalación de dependencias:
sudo apt update

sudo apt install -y postgresql postgresql-contrib libpq-dev build-essential

sudo -u postgres createuser --pwprompt superset
sudo -u postgres createdb --owner=superset superset


sudo apt update

sudo apt install -y build-essential libssl-dev zlib1g-dev libncurses5-dev libncursesw5-dev libreadline-dev libsqlite3-dev libgdbm-dev libdb5.3-dev libbz2-dev libexpat1-dev liblzma-dev tk-dev libffi-dev git curl wget libpq-dev libmysqlclient-dev libcurl4-openssl-dev libjpeg-dev python3-pip python3-dev libldap2-dev libsasl2-dev libssl-dev vim nodejs npm python3-venv
(Si el sistema es Ubuntu 24 hace falta Python 3.10), tiene 3.12. En Ubuntu 22 no hace falta ya lo tiene.
Para instalar Python 3.10:
cd /usr/src

sudo wget https://www.python.org/ftp/python/3.10.14/Python-3.10.14.tgz

sudo tar xzf Python-3.10.14.tgz

cd Python-3.10.14

sudo ./configure --enable-optimizations

sudo make -j$(nproc)

sudo make altinstall


Una vez se tiene Python 3.10 seguir con la instalación:
git clone --branch 4.1.2 --depth 1 https://github.com/apache/superset.git 

python3 -m venv venv

source venv/bin/activate

pip install --upgrade pip setuptools wheel

cd superset/

 

pip install -r requirements/development.txt

pip install -e .

 

openssl rand -hex 64
Con el resultado anterior completar secret key del comando anterior y path a db:
vi superset_config.py

Coger el contenido de https://superset.apache.org/docs/configuration/configuring-superset/#secret_key-rotation
export SUPERSET_CONFIG_PATH=superset_config.py

export FLASK_APP=superset

superset db upgrade

superset fab create-admin --username admin --firstname Admin --lastname User --email admin@example.com --password Idearium2025!

superset load_examples

cd superset-frontend/

Ahora para compilar el front de superset:
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash

source ~/.bashrc

nvm install 18

nvm use 18

 

npm install core-js@3.37.1 --debug

npx update-browserslist-db@latest

npm run build --debug

Iniciar Superset una vez que ha compilado todo correctamente:
superset init

superset run -p 8088 -h 0.0.0.0 --with-threads --reload --debugger
Para la ejecución posterior (Si no se establece Superset como servicio) hay que hacer cada vez que se quiera arrancar superset:
cd superset/

. ../venv/bin/activate

export SUPERSET_CONFIG_PATH=superset_config.py

export FLASK_APP=superset

superset init

superset run -p 8088 -h 0.0.0.0 --with-threads --reload --debugger







Establecer superset como servicio
Para establecer Superset como servicio y que arranque solo cada vez que se encienda la máquina y sea más sencillo pararlo, iniciarlo y reiniciarlo, se puede hacer lo siguiente:
Crear el fichero de unidad
sudo nano /etc/systemd/system/superset.service

Figura 1: Fichero de unidad
Una vez creado y guardado ese fichero habilitar el servicio:
sudo systemctl daemon-reload
sudo systemctl enable superset
Una vez habilitado arrancar el servicio:
sudo systemctl start superset
Para parar:
sudo systemctl stop superset

Para ver el estado (si está activo o inactivo):
sudo systemctl status superset

Figura 2: Estado servicio superset




INSTALACIÓN PLUGIN OPENLAYERS
Para instalar el plugin de visualización de mapas de OpenLayers, lo primero es clonar de este repositorio: https://github.com/frankrowe/superset-plugin-chart-openlayers
git clone https://github.com/frankrowe/superset-plugin-chart-openlayers.git
cd superset-plugin-chart-openlayers

Figura 3: Plugin clonado
Editar tsconfig.json
Para añadir:
"references": [
  {
    "path": "../../packages/superset-ui-chart-controls"
  },
  {
    "path": "../../packages/superset-ui-core"
  }
]
Y:
"../../types/**/*"

"extends": "../../tsconfig.json",
“If your Superset plugin exists in the superset-frontend directory and you wish to resolve TypeScript errors about @superset-ui/core not being resolved correctly, add the following to your tsconfig.json” Y
“You may also wish to add the following to the include array in tsconfig.json to make Superset types available to your plugin:”
Así queda:


Figura 4: tsconfig.json modificado
Para modificar el Plugin internamente estos son los ficheros que se deben tocar


Una vez hecho esto compilar el plugin con:
npm ci
npm run build
Ahora desde la carpeta de la instalación del frontend, enlazar al plugin:
cd ../superset/superset-frontend
npm install --save ../../superset-plugin-chart-openlayers

Para comprobar que está bien enlazado
npm ls superset-plugin-chart-openlayers

Figura 5: Plugin correctamente enlazado
Ahora se tiene que modificar el MainPresets.js para añadir el plugin, está aquí 
superset-frontend/src/visualizations/presets/MainPreset.js Añadir:
import { SupersetPluginChartOpenlayers } from 'superset-plugin-chart-openlayers';

new SupersetPluginChartOpenlayers().configure({ key: 'superset-plugin-chart-openlayers' }),
Por último, limpiar y volver a compilar el front de superset en /superset/superset-frontend:
rm -rf node_modules/.cache

npm run build --debug
Y ya estaría instalado, para usarlo hay que seleccionar el chart tipo OpenLayers:

Figura 6: Vista del plugin en superset
Un ejemplo de mapa representado en Superset con este plugin el de municipios de Aragón:

Figura 7: Municipios Aragón


